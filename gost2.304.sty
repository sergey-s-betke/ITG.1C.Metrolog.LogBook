\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{gost2.304}[2014/10/22 v0.1 GOST 2.304-81]

\RequirePackage{ifxetex}
\RequireXeTeX

\RequirePackage[T2A,T1]{fontenc}
\RequirePackage{xecyr}

% Enable loading of OpenType fonts
\usepackage[cm-default]{fontspec}
\defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}

% подключаем чертёжные шрифты типа A
\DeclareOption{A}{
	\newfontfamily\gostfontA{GOST 2.304-81 type A}[
		Path = fonts/ ,
		Extension = .ttf ,
		% UprightFont = * ,
		BoldFont = * ,
		BoldFeatures = { FakeBold = 1.5 } ,
		ItalicFont = * Italic ,
		BoldItalicFont = * Italic ,
		BoldItalicFeatures = { FakeBold = 1.5 } ,
		% SlantedFont = * Italic ,
		% BoldSlantedFont = * Bold Italic,
		% SmallCapsFont = *
	]
	\let\gostA\gostfontA
	\let\gostfont\gostfontA
	\setmainfont{GOST 2.304-81 type A}[
		Path = fonts/ ,
		Extension = .ttf ,
		% UprightFont = * ,
		BoldFont = * ,
		BoldFeatures = { FakeBold = 1.5 } ,
		ItalicFont = * Italic ,
		BoldItalicFont = * Italic,
		BoldItalicFeatures = { FakeBold = 1.5 } ,
		% SlantedFont = * Italic ,
		% BoldSlantedFont = * Bold Italic,
		% SmallCapsFont = *
	]
}

% подключаем чертёжные шрифты типа B
\DeclareOption{B}{
	\newfontfamily\gostfontB{GOST 2.304-81 type B}[
		Path = fonts/ ,
		Extension = .ttf ,
		% UprightFont = * ,
		BoldFont = * ,
		BoldFeatures = { FakeBold = 1.5 } ,
		ItalicFont = * Italic ,
		BoldItalicFont = * Italic ,
		BoldItalicFeatures = { FakeBold = 1.5 } ,
		% SlantedFont = * Italic ,
		% BoldSlantedFont = * Bold Italic,
		% SmallCapsFont = *
	]
	\let\gostB\gostfontB
	\let\gostfont\gostfontB
	\setmainfont{GOST 2.304-81 type B}[
		Path = fonts/ ,
		Extension = .ttf ,
		% UprightFont = * ,
		BoldFont = * ,
		BoldFeatures = { FakeBold = 1.5 } ,
		ItalicFont = * Italic ,
		BoldItalicFont = * Italic ,
		BoldItalicFeatures = { FakeBold = 1.5 } ,
		% SlantedFont = * Italic ,
		% BoldSlantedFont = * Bold Italic,
		% SmallCapsFont = *
	]
}

\ExecuteOptions{B}

\ProcessOptions\relax

\let\ESKDfontShape\gostfont
%\ESKD@docfont
